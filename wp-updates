#!/bin/bash

# Plugins, die nicht aktualisiert werden sollen
EXCLUDE_PLUGINS=("woocommerce-product-stock-alert" "tiktok-for-woocommerce")

# Hole alle installierten Plugins
INSTALLED_PLUGINS=$(${HOME}/yps.tools/wp --path="${HOME}/public_html" plugin list --field=name)

# Filtere die Plugins, die aktualisiert werden sollen
PLUGINS_TO_UPDATE=""
for PLUGIN in $INSTALLED_PLUGINS; do
  if [[ ! " ${EXCLUDE_PLUGINS[@]} " =~ " ${PLUGIN} " ]]; then
    PLUGINS_TO_UPDATE+="${PLUGIN} "
  fi
done

# Aktualisiere WordPress Core
echo "ðŸ”„ Update Wordpress Core"
${HOME}/yps.tools/wp --path="${HOME}/public_html" core update

# Aktualisiere alle Themes
echo "ðŸ”„ Update Themes"
${HOME}/yps.tools/wp --path="${HOME}/public_html" theme update --all

echo "ðŸ”„ Update Wordpress Plugins"
# Aktualisiere die ausgewÃ¤hlten Plugins
for PLUGIN in $PLUGINS_TO_UPDATE; do
  ${HOME}/yps.tools/wp --path="${HOME}/public_html" plugin update $PLUGIN
done
# Aktualisiere die WordPress-Datenbank
echo "ðŸ”„ Update Database"
${HOME}/yps.tools/wp --path="${HOME}/public_html" core update-db